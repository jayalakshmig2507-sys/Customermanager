<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>✨ Magic To-Do</title>
 <style>
 body { font-family: system-ui, -apple-system, sans-serif; max-width: 400px; margin: 50px
auto; padding: 20px; background-color: #f4f4f9; }
 h1 { text-align: center; color: #333; }

 /* Input Area */
 #inputArea { display: flex; gap: 10px; margin-bottom: 20px; }
 #taskInput { flex-grow: 1; padding: 12px; font-size: 16px; border: 1px solid #ddd; borderradius: 4px; }
 #addBtn { padding: 12px 20px; font-size: 16px; cursor: pointer; background-color: #007bff;
color: white; border: none; border-radius: 4px; }
 #addBtn:hover { background-color: #0056b3; }
 #addBtn:disabled { opacity: 0.6; cursor: wait; background-color: #ccc; }
 /* Task List */
 ul { list-style-type: none; padding: 0; }
 li { padding: 15px; background: #fff; margin-bottom: 10px; border-radius: 6px; cursor:
pointer; display: flex; justify-content: space-between; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
transition: 0.2s; }
 li:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

 .delete-hint { color: #ff4d4d; font-size: 0.8em; opacity: 0; transition: opacity 0.2s; }
 li:hover .delete-hint { opacity: 1; }
 </style>
</head>
<body>
 <h1>✨ Magic To-Do</h1>

 <div id="inputArea">
 <input type="text" id="taskInput" placeholder="Enter a task..." maxlength="60"
autocomplete="off">
☁️ Doing Business on the Cloud
 <button id="addBtn">Add</button>
 </div>
 <ul id="taskList">
 <li style="cursor: default; background: none; box-shadow: none; color: #888; text-align:
center;">Loading data...</li>
 </ul>
 <script type="module">
 // 1. Import Firebase v11 (No build tools needed!)
 import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
 import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, serverTimestamp,
query, orderBy }
 from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";
 // 2. CONFIGURATION (Replace with your keys!)
 // TODO: Paste your specific keys from Firebase Console here
 const firebaseConfig = {
  apiKey: "AIzaSyAqDsqgTeRD3sAXncZVPFkKinOVYZ2VXo4",
  authDomain: "customer-enquiry-manager.firebaseapp.com",
  projectId: "customer-enquiry-manager",
  storageBucket: "customer-enquiry-manager.firebasestorage.app",
  messagingSenderId: "917955055710",
  appId: "1:917955055710:web:5fb547b9462eda55fde4cf",
  measurementId: "G-890LYDT9CW"
};
 // 3. Initialize App & Database
 const app = initializeApp(firebaseConfig);
 const db = getFirestore(app);
 const tasksCol = collection(db, "tasks");
 // 4. UI Elements
 const taskInput = document.getElementById("taskInput");
 const addBtn = document.getElementById("addBtn");
 const taskList = document.getElementById("taskList");
 // 5. FUNCTION: Add Task
 async function addTask() {
 // Data Hygiene: Trim whitespace and enforce limit
 const text = taskInput.value.trim().slice(0, 60);
 if (!text) return;
 try {
 addBtn.disabled = true;
 addBtn.textContent = "Saving...";

 await addDoc(tasksCol, {
 text: text,
 created: serverTimestamp()
 });

 taskInput.value = "";
 taskInput.focus();
 } catch (e) {
 console.error(e);
 alert("Error adding task: " + e.message);
 } finally {
☁️ Doing Business on the Cloud
 addBtn.disabled = false;
 addBtn.textContent = "Add";
 }
 }
 // 6. EVENT LISTENERS
 addBtn.onclick = addTask;
 taskInput.addEventListener("keydown", (e) => { // Keydown is safer than keypress
 if (e.key === "Enter") addTask();
 });
 // 7. REAL-TIME SYNC (The Magic)
 const q = query(tasksCol, orderBy("created", "desc"));
 onSnapshot(q, (snapshot) => {
 taskList.innerHTML = "";

 if (snapshot.empty) {
 taskList.innerHTML = "<li style='background:none; box-shadow:none; color:#888;
justify-content:center; cursor:default'>No tasks yet!</li>";
 return;
 }
 snapshot.forEach((taskDoc) => {
 const li = document.createElement("li");

 // SECURITY: Use textContent to prevent XSS attacks
 const span = document.createElement("span");
 span.textContent = taskDoc.data().text;
 li.appendChild(span);
 const hint = document.createElement("span");
 hint.className = "delete-hint";
 hint.textContent = "Tap to delete";
 li.appendChild(hint);
 // Confirm before delete
 li.onclick = () => {
 if(confirm("Delete this task?")) {
 deleteDoc(doc(db, "tasks", taskDoc.id));
 }
 };

 taskList.appendChild(li);
 });
 }, (error) => {
 console.error("Real-time error:", error);
 taskList.innerHTML = "<li style='color:red'>Error. Check console (F12). If 'Index
Required', click the link in console.</li>";
 });
 </script>
</body>
</html>
